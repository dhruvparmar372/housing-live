!function(e,t,n,r){"use strict";function i(e){new b($.extend(e,{append_to:"#results-list"}));v.addClass("inactive")}function a(e){new _(e,i)}function s(){d=$("body"),p=$("#results-list"),m=$("#tags-list"),v=$("#wave-container")}function o(){$("#page-title").addClass("animate"),$("#wave-container").addClass("animate"),$("#search-box").addClass("animate"),$("#help-text").addClass("animate"),setTimeout(function(){$(".dummy-line").addClass("addWidth")},1e3),setTimeout(function(){$(".dummy-line").addClass("addColor")},1500),setTimeout(function(){$("#powered-by-housing").addClass("move")},2500)}function l(){$(window).on("scroll",u(function(){c()},50))}function c(){var e=pageYOffset;e>75&&"center"==h&&(h="top",$(d).addClass("top-search-bar")),75>e&&"top"==h&&(h="center",$(d).removeClass("top-search-bar"))}function u(e,t,n){t||(t=250);var r,i;return function(){var a=n||this,s=+new Date,o=arguments;r&&r+t>s?(clearTimeout(i),i=setTimeout(function(){r=s,e.apply(a,o)},t)):(r=s,e.apply(a,o))}}var d,p,m,f,v,h="center",_=function(i,a){function s(){for(var e=0;e<x.length;){var t=x[e++];i.indexOf(t)>-1&&(i=i.replace(t,""),y.services.push(t))}for(e=0;e<y.services.length;)"paying guest"===y.services[e]&&(y.services.splice(e,1),y.services.push("pg")),e++}function o(e){var t,n=l(),r=c();n.forEach(function(t){e=e.replace(t,"")});var i=b();i.forEach(function(t){e=e.replace(t,"")});var a,s=e;s=s.toLowerCase();for(var o=0;o<r.length;){for(var d=0;d<r[o].length;){if(a=r[o][d].toLowerCase(),s.indexOf(a)>-1)return e=e.replace(r[o][d].toLowerCase(),""),e=e.replace(" s ",""),{id:[o+1],updated_text:e,apartment_type_tag:r[o][d]};d++}o++}for(s=s.toLowerCase().replace(/ /,""),o=0;o<r.length;){for(d=0;d<r[o].length;){if(a=r[o][d].toLowerCase().replace(/ /,""),s.indexOf(a)>-1)return e=e.replace(r[o][d].toLowerCase(),""),e=e.replace(" s ",""),{id:[o+1],updated_text:e,apartment_type_tag:r[o][d]};d++}o++}return t=u(),{id:[],updated_text:e,apartment_type_tag:""}}function l(){var e=[],t=["apartment","flat","home","house","kitchen","halls","hall","halls","bath","bathroom","bathroom","area","property","duplex","triplex"],n=["search","find","give","need","want","look","up","provide","result","bring","face"];return e.concat(t,n)}function c(){return[["1 RK","1 Room","1 Room"],["1 BHK","1 Bedroom","1 Bedroom","1 Bedroom","2 Rooms","1 Bedroom"],["1.5 BHK","2 BHK","2 RK","2 BH","3 R","3 RK","2 Bedroom","2 Bedrooms","2 Rooms","2 Room"],["2.5 BHK","2.5 BH","3 BHK","3 RK","3 Room","3 Bedroom","2.5 Bedroom","3 Room","3 Rooms","3 R"],["4 BHK","5 BHK","6 BHK","4 Bedroom","5 Bedroom","6 Bedroom","7 Bedroom","4 BH","5 BH","6 BH","4 Bedroom","5 Bedroom","6 Bedroom","7 Bedroom"]]}function u(){return["Bedroom","Room"]}function d(){i=p(v("-"," ",i));var e=m(i);y.filters.min_price=e.min_budget,y.filters.max_price=e.max_budget}function p(e){var e=e.split(" "),t=[];return e.forEach(function(n,r){var i=w.indexOf(n),a=e.indexOf(n),s=0,o=0;-1!=i&&a>0?(o=e[a-1],parseInt(o)?(s=o*B[i],e[r]+="x",t.push(s)):t.push(n)):t.push(n)}),t.join(" ")}function m(e){var t=e.split(" ").filter(function(e){return parseInt(e)?parseInt(e):void 0}),n={};if(t.length){var r=[];return r=t.filter(function(e){return e>3500?e:void 0}),r.length?(r=r.map(function(e){return parseInt(e)}),r=r.sort(f),n.max_budget=null,n.min_budget=null,1==r.length?n.max_budget=r[0]:2==r.length?(n.min_budget=r[0],n.max_budget=r[1]):(n.min_budget=r[0],n.max_budget=r[r.length-1]),n):{}}return{}}function f(e,t){return e-t}function v(e,t,n){return n.replace(new RegExp(e,"g"),t)}function h(){i?_(i,g.bind(this,y.filters)):a.call(null,y)}function _(i,s){var o,l;if(t.forEach(function(t){if(!o){var n=e[t];o=n.filter(function(e){var t=new RegExp(e,"i");return i.match(t)}),o&&!o.length>0&&(o=void 0)}}),o&&o[0]||(o=n.filter(function(e){var t=new RegExp(e,"i");return i.match(t)})),l=r.filter(function(e){var t=new RegExp(e,"i");return i.match(t)}),l=l&&l[0]?l[0]:"",o=o&&o[0]?o[0]:"",o||l){o&&l&&(l=", "+l);var c=encodeURIComponent(o+l);$.ajax({url:"https://buy.housing.com/api/v0/search/suggest/?&string="+c,success:function(e){s({id:e[0].uuid,name:e[0].name})}})}else a.call(null,y)}function g(e,t){e.poly=t.id,e.poly_tag=t.name,a.call(null,y)}function b(){return[" of "," a "," an "," the "," I "," in "," near "]}var y={services:[],filters:{}},x=["rent","buy","pg","paying guest"],w=["lakhs","lakh","million","millions","crore","crores","thousand","thousands"],B=["100000","100000","1000000","1000000","10000000","10000000","10000","10000"],i=i&&i.toLowerCase();ga("send","event","query","submitted",i),i=" "+i+" ",i=v(" to "," 2 ",i),i=v(" by "," buy ",i),i=v(" bye "," buy ",i),console.log("initial query ",i),s();var C=o(i);return i=C.updated_text,y.filters.apartment_type_id=C.id,y.apartment_type_tag=C.apartment_type_tag,d(),h(),this},g=function(e){var t=$(e.append_to),n=$("<button id='start-search-btn' class='app-btn'>Start Search</button>"),r=$("<button id='close-search-btn' class='app-btn'>Stop</button>"),i=new webkitSpeechRecognition,a=(e.done_callback,this),s=function(){a.listening||(a.listening=!0,n=$("#start-search-btn"),t.addClass("loading"),n.addClass("pulse"),setTimeout(function(){$("#start-search-btn").removeClass("pulse")},400),v.removeClass("inactive"),$("#guide-text").text("I am listening now ... "),i.start())},o=function(){$("html, body").animate({scrollTop:0},500),s()},l=function(){a.listening&&(a.listening=!1),t.removeClass("loading"),v.addClass("inactive"),$("#guide-text").text("Say 1 BHK in Powai between 10000 to 20000..."),i.stop()},c=function(n){var r=e.done_callback;if(n.results.length>0){var i=n.results[n.results.length-1];i.isFinal&&("function"==typeof r&&r.call(this,i[0].transcript),t.removeClass("loading"),a.listening=!1)}};i.lang=e.language||"en",i.onresult=c,n.bind("click",s),r.bind("click",l),$(".search-float").bind("click",o),t.append(n),t.append(r)},b=function(e){function t(e){return"Rs. "+e}e.filters&&e.filters.min_price>1e5&&0==e.services.length&&(e.services[0]="buy");var n={rent:{url:"https://rails.housing.com//api/v3/rent/filter?",transform_results:function(e){return e.hits.hits.map(function(e){return e._source})},base_filters:{details:!0},get_rendered_item:function(e){var t=e.thumb_url_new?e.thumb_url_new.replace("version","medium"):"",n="background-image: url("+t+");",r=e.canonical_url,i="<a class='result pull-left' target='_blank' service='rent' data-id="+e.id+" href="+r+"><div class='image-wrapper'><div class='image-container' style='"+n+"'></div></div><div class='details-container'><div class='apartment-type ellipsis'>"+e.seo_title+"</div><div class='locality'>"+e.street_info+"</div><div class='price'> &#8377; "+e.formatted_rent+"</div></div></a>";return $(i)}},buy:{url:"https://buy.housing.com/api/v1/buy/index/filter?",transform_results:function(e){return e.hits},get_rendered_item:function(e){var t="project"==e.type?"_m":"medium",n="https://housing.com"+e.inventory_canonical_url,r=e.thumb_image_url?e.thumb_image_url.replace("version",t):"",i="background-image: url("+r+");",a=e.price_on_request?"Price on request":" &#8377; "+e.formatted_price,s="<a class='result pull-left' target='_blank' service='buy' data-id="+e.id+" href="+n+"><div class='image-wrapper'><div class='image-container' style='"+i+"'></div></div><div class='details-container'><div class='apartment-type ellipsis'>"+e.title+"</div><div class='locality'>"+e.street_info+"</div><div class='price'>"+a+"</div></div></a>";return $(s)}},pg:{url:"https://pg.housing.com/api/v3/pg//filter?",base_filters:{details:!0},transform_results:function(e){return e.hits.hits.map(function(e){return e._source})},get_rendered_item:function(e){var t=e.thumb_url?e.thumb_url.replace("thumb","medium").replace("version","medium"):"",n="background-image: url("+t+");",r=e.canonical_url,i="<a class='result pull-left' target='_blank' service='pg' data-id="+e.id+" href='"+r+"'><div class='image-wrapper'><div class='image-container' style='"+n+"'></div></div><div class='details-container'><div class='apartment-type ellipsis'>"+e.apartment_type+"</div><div class='locality'>"+e.street_info+"</div><div class='price'> &#8377; "+e.formatted_min_rent+"</div></div></a>";return $(i)}}},r=["buy","rent"],i={sort_key:"relevance",results_per_page:30},a=[];e.apartment_type_tag&&a.push(e.apartment_type_tag);$(e.append_to);e.filter=$.extend(e.filters,i),0===e.services.length&&(e.services=r),e.filter&&e.filter.poly_tag&&a.push(e.filter.poly_tag);var s="";e.filters&&e.filters.min_price&&(s=t(e.filters.min_price)),e.filters&&e.filters.max_price&&(s?s+=" - "+t(e.filters.max_price):s=t(e.filters.max_price)),s&&a.push(s),e.services&&(a=a.concat(e.services));var o=function(e,t){var r=n[t],i=r&&r.url,a=$.extend(e,r.base_filters);if(!i)return void console.error("did not find url for service");for(var s in a){switch(s){case"apartment_type_id":e[s]&&e[s].length&&(i=i+"apartment_type_id="+e[s].join(","));break;case"sort_key":case"poly":case"results_per_page":case"details":case"max_price":case"min_price":e[s]&&(i=i+"&"+s+"="+e[s].toString());break;default:i=i}("pg"===t||"rent"===t)&&("max_price"===s&&e.max_price&&(i+="&max_rent="+e.max_price),"min_price"===s&&e.min_price&&(i+="&min_rent="+e.min_price))}return i},l=function(e,t){var r=n[t];return new RSVP.Promise(function(t,n){$.getJSON(e).then(function(e){t(r.transform_results(e))},function(e){n(e)})})};RSVP.Promise.all(e.services.map(function(t){var n=o(e.filters,t);return RSVP.hash({results:l(n,t),service:t})})).then(function(e){var t=!0;if(e.forEach(function(e){e.results&&e.results.length&&(t=!1)}),t)return $("#main-content").addClass("empty-list");$("#main-content").removeClass("empty-list"),m.empty();var r=[];a.forEach(function(e){if(e){var t="<li class='tag-item'>"+e+"</li>";r.push($(t))}}),m.append(r),p.empty();var i=[];e.forEach(function(e){var t=e.results,r=n[e.service];t.forEach(function(e){i.push(r.get_rendered_item(e))})}),setTimeout(function(){var e=$("#results-list").offset().top-$("#top-header").height()-10;$("html, body").animate({scrollTop:e},500)},100),p.append(i),$("#results-list .result").slice(0,9).each(function(e){setTimeout(function(){$("#results-list .result").eq(e).addClass("show")},150*(e+1))}),setTimeout(function(){$("#results-list .result").addClass("show")},2100)})},y=function(){s(),l();new g({append_to:"#search-box",done_callback:a});o();{var e=Math.min(.8*$(window).innerWidth(),600);$("#wave-container").addClass("inactive")}f=new SiriWave9({width:e,height:Math.floor(e/3),color:["#f2b632","#b5b5b7","#677077","#252839"],speed:1,container:document.getElementById("wave-container"),autostart:!0})};$(document).ready(y)}(city_location,location_cities,cities,states);